#!/usr/bin/python3
# Simple TCP fuzz against a target
import socket
from sys import exit, argv

if len(argv) < 3:
    print("Performs a simple fuzz against a target")
    print(f"Usage: {argv[0]} <Target IP Address/hostname> <Target Port>")
    exit(1)

# Create an array of buffers, from 10 to 2000, with increments of 20.
buffer = ["A"]
counter = 100
while len(buffer) <= 30:
    buffer.append("A" * counter)
    counter += 200

for string in buffer:
    print(f"Fuzzing {argv[1]}:{argv[2]} with {len(string)} bytes")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect((argv[1], int(argv[2])))
        s.recv(1024)  # Grab the banner, do not remove
        s.send((string + "\r\n").encode())  # Sends your evil buffer as 'string'
        s.send(b'QUIT\r\n')  # Replace 'QUIT' with whatever ends your session
        s.close()
    except Exception as e:
        print(f"Connection failed: {e}")
        break
